<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive JSON Viewer</title>
  <style>
    body {
      font-family: monospace;
      background: #ffffff;
      padding: 20px;
    }
    h2 {
      font-family: sans-serif;
    }
    .checkbox-group label {
      display: block;
      margin-bottom: 8px;
    }
    /* indent the SB under FR */
    #SB_container {
      margin-left: 24px;
      display: block;
    }
    /* indent the PT toggle under PT */
    #PT_toggle_container {
      margin-left: 24px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    /* Smaller toggle switch styling */
    .switch {
      position: relative;
      display: inline-block;
      width: 40px;   /* reduced from 60px */
      height: 20px;  /* reduced from 30px */
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .3s;
      border-radius: 20px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 14px;  /* reduced from 22px */
      width: 14px;   /* reduced from 22px */
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #2196F3;
    }
    input:checked + .slider:before {
      transform: translateX(20px); /* adjusted to new width */
    }
    pre {
      background-color: #f5f5f5;
      padding: 16px;
      border-radius: 8px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h2>ðŸ“¦ Toggle JSON Sections</h2>

  <div class="checkbox-group">
    <label><input type="checkbox" id="FR" checked> Full Response (FR)</label>
    <div id="SB_container">
      <label><input type="checkbox" id="SB" checked> Summary Block from FR (SB)</label>
    </div>

    <label><input type="checkbox" id="PT" checked> Payment Transaction Data (PT)</label>
    <div id="PT_toggle_container">
      <span>Matched by</span>
      <span>Phone</span>
      <label class="switch">
        <input type="checkbox" id="PT_toggle">
        <span class="slider"></span>
      </label>
      <span>Email</span>
    </div>

    <label><input type="checkbox" id="TS" checked> Telco Score and Loan Application Check (TS)</label>
    <label><input type="checkbox" id="LR" checked> LenderLink Lite (LR)</label>
    <label><input type="checkbox" id="CHA" checked> Credit History Aggregated (CHA)</label>
    <label><input type="checkbox" id="LAC" checked> Loan Applications Check (LAC)</label>
  </div>

  <pre id="output"></pre>

  <script>
    const base = {
      requestId: "X123-AB45",
      productIds: [],
      response: {}
    };

    const sections = {
      FR: {
        data: [
          {
            recordID: "123456789",
            kycSurname: "Doe",
            kycFirstName: "John",
            kycMiddleName: "Smith",
            kycDateOfBirth: "1990-01-01",
            kycIdNumber: "ABC123456",
            kycIdType: 4,
            kycMobileNumber: "63XXXXXXXXXX",
            kycEmailAddress: "john.doe@example.com",
            kycAddress: "123 Main St, Anytown, USA",
            loanInfoLoanType: 1,
            loanInfoApplicationDate: "2022-01-01",
            loanInfoOpenDate: "2022-01-01",
            loanInfoLoanTerm: 5,
            loanInfoOpenBalance: 10000,
            loanInfoOutstandingBalance: 8000,
            loanInfoNextDueDate: "2024-05-01",
            loanInfoLastPaymentAmount: 200,
            loanInfoLastPaymentDate: "2024-04-01",
            loanInfoStatusCode: "Active",
            loanInfoInstallmentAmount: 500,
            loanInfoOverdueAmount: 100,
            loanInfoRepaymentFrequency: 1,
            loanInfoRepaymentHistory: "00000",
            loanInfoCloseDate: "2023-12-28",
            contributorId: "12d3ae45-678d-9ae1-2345-6e789e3xx000"
          }
        ],
        summary: {
          numApp: 1,
          numAcc: 1,
          wasDpd30Ever: 1,
          wasDpd90Ever: 0,
          wasDpd30Last3Months: 0,
          wasDpd90Last3Months: 0,
          wasDpd30LastYear: 0,
          wasDpd90LastYear: 0
        }
      },
      PT: {
        transactionCount: 4,
        minAmount: 1985,
        maxAmount: 6656,
        aveAmount: 3531.5,
        sumAmount: 14126,
        stdDev: 1839.28,
        refDates: [
          "2025-03-19",
          "2025-04-30",
          "2025-05-10",
          "2025-05-18"
        ],
        refDateDetails: [
          { refDate: "2025-03-19", count: 1, total: 6656 },
          { refDate: "2025-05-18", count: 1, total: 2485 },
          { refDate: "2025-04-30", count: 1, total: 1985 },
          { refDate: "2025-05-10", count: 1, total: 3000 }
        ],
        categories: [ "Loans" ],
        procIds: [ "GCSH" ],
        within1to30Days: [],
        within31to60Days: [],
        beyond61Days: [
          {
            category: "Loans",
            transactionCount: 4,
            minAmount: 1985,
            maxAmount: 6656,
            sumAmount: 14126,
            stdDev: 1839.28
          }
        ],
        matchKey: "cellphoneNumber"
      },
      TS: { transactionId: "f2279c3df6eb4368a8ec31c0ca561c8a", code: "0000", result: "ok" },
      LR: { msisdn: "63XXXXXXXXXX" },
      CHA: { document: null },
      LAC: { result: "ok" }
    };

    const updateJSON = () => {
      const result = { ...base, productIds: [], response: {} };

      // Show/hide SB based on FR
      const frChecked = document.getElementById("FR").checked;
      const sbContainer = document.getElementById("SB_container");
      const sb = document.getElementById("SB");
      sbContainer.style.display = frChecked ? "block" : "none";
      if (!frChecked) sb.checked = false;

      // Show/hide PT toggle based on PT
      const ptChecked = document.getElementById("PT").checked;
      const ptToggleContainer = document.getElementById("PT_toggle_container");
      ptToggleContainer.style.display = ptChecked ? "flex" : "none";

      for (const id of ["FR", "PT", "TS", "LR", "CHA", "LAC"]) {
        if (document.getElementById(id).checked) {
          result.productIds.push(id);

          if (id === "FR") {
            const frCopy = JSON.parse(JSON.stringify(sections.FR));
            if (!sb.checked) delete frCopy.summary;
            result.response[id] = frCopy;
          } else if (id === "PT") {
            const ptCopy = JSON.parse(JSON.stringify(sections.PT));
            ptCopy.matchKey = document.getElementById("PT_toggle").checked ? "email" : "cellphoneNumber";
            result.response[id] = ptCopy;
          } else {
            result.response[id] = sections[id];
          }
        }
      }

      document.getElementById("output").textContent = JSON.stringify(result, null, 2);
    };

    // Event listeners
    for (const id of ["FR", "PT", "TS", "LR", "CHA", "LAC"]) {
      document.getElementById(id).addEventListener("change", updateJSON);
    }
    document.getElementById("SB").addEventListener("change", updateJSON);
    document.getElementById("PT_toggle").addEventListener("change", updateJSON);

    // Initial render
    updateJSON();
  </script>
</body>
</html>
